// ========================================================
// Dependencies
// ========================================================
@use 'sass:color';
@import '~@epr0t0type/bankai-lib-style-utils/src/styles/mixins/animations.scss';
@import '~@epr0t0type/bankai-lib-style-utils/src/styles/mixins/layout.scss';
@import '~@epr0t0type/bankai-lib-style-utils/src/styles/mixins/resets.scss';
@import '~@epr0t0type/bankai-lib-style-utils/src/styles/utils/unit-conversion-utils.scss';
@import '~@epr0t0type/bankai-lib-theme-utils/src/styles/mixins/typography.scss';
@import '~@epr0t0type/bankai-lib-theme-utils/src/styles/utils/theme-utils.scss';
@import '~@epr0t0type/bankai-ui-buttons/src/styles/button.scss';
@import '~@epr0t0type/bankai-ui-buttons/src/styles/mixins.scss';

.bankai-dnd-file-uploader, %bankai-dnd-file-uploader {
    min-height: 142px;

    &__inner {
        @include bankai-flex-column;
        text-align: center;
        box-sizing: border-box;
        border-radius: var(--bankai-form-input-border-radius, bankai-light-theme('form-input-border-radius'));
        border: 2px dashed var(--bankai-color-universal-border, bankai-light-theme('color-universal-border'));
        padding: #{bankai-to-rem(bankai-light-theme('layout-grid-base') * 4)};
    }

    .bankai-dropzone,
    &__inner {
        min-height: 142px;
    }

    &__content-container {
        @include bankai-flex-column;
        margin: auto 0;
    }

    &__attachments-list {
        @include bankai-list-reset;
        @include bankai-flex-row;
        flex-wrap: wrap;
        justify-content: center;

        &-item {
            @include bankai-flex-row;
            min-width: 1px;
            flex: 0 1 auto;
            margin: 2px;
        }

        &-item-inner {
            @include bankai-flex-row;
            min-width: 1px;
            background-color: var(--bankai-color-form-pill-bg, bankai-light-theme('color-form-pill-bg'));
            color: var(--bankai-color-form-pill-text, bankai-light-theme('color-form-pill-text'));
            border-radius: var(--bankai-btn-border-radius, bankai-light-theme('btn-border-radius'));
            margin: 0 auto;
            flex: 0 1 auto;
        }
    }

    &__attachment-remove-btn {
        color: inherit;
        background-color: transparent;

        .bankai-button__content-container {
            padding: #{bankai-to-rem(bankai-light-theme('layout-grid-base'))};
        }

        .bankai-button__icon-safe-space {
            width: 1.4rem;
        }

        .bankai-button__icon {
            font-size: 1.4rem;
        }
    }

    &__title {
        @include bankai-h4;
        min-width: 1px;
        text-overflow: ellipsis;
        white-space: nowrap;
        overflow: hidden;
        flex: 1 1 auto;
    }

    &__attachment-file-name {
        box-sizing: border-box;
        padding-left: #{bankai-to-rem(bankai-light-theme('layout-grid-base') * 3)};
        margin: auto 0;
    }

    &__icon-container + &__messaging-container,
    &__title-container + &__msg-container,
    &__attachments-list + &__msg-container {
        margin-top: #{bankai-to-px(bankai-light-theme('layout-grid-base'))};
    }

    &__icon-container-inner {
        width: 30px;
        height: 30px;
        margin: auto;
        display: flex;
    }

    &__icon {
        font-size: 3rem;
        display: inline-block;
        margin: auto;
    }

    &__msg {
        line-height: var(--bankai-typography-line-height, bankai-light-theme('typography-line-height'));
        margin: 0;
    }

    &__browse-btn-container {
        box-sizing: border-box;
        display: inline-block;
        position: relative;

        &:hover {
            cursor: pointer;
        }
    }

    &__browse-btn {
        appearance: button;
        display: inline-block;

        &.bankai-button--secondary {
            @extend %bankai-button;
            @extend %bankai-button--secondary;
        }
    }

    &__browse-input {
        width: 100%;
        box-sizing: border-box;
        line-height: 1;
        position: absolute;
        z-index: 1;
        opacity: 0;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;

        &:enabled {
            cursor: pointer;
        }

        &:active + .bankai-button--secondary {
            @include bankai-button-active;
        }

        &:hover {
            @media (hover: hover) {
                + .bankai-button--secondary {
                    @include bankai-button-secondary-hover;
                }

                + .bankai-link-button .bankai-link-button__text {
                    @include bankai-link-button-hover;
                }
            }
        }

        &:focus-visible + .bankai-button {
            @include bankai-button-secondary-focus-visible;
        }

        &:focus-visible + .bankai-link-button {
            @include bankai-link-button-focus-visible;
        }
    }

    &__msg--default {
        .bankai-dnd-file-uploader__msg-text {
            display: block;
        }

        .bankai-dnd-file-uploader__msg-text + .bankai-dnd-file-uploader__browse-btn-container {
            margin-top: #{bankai-to-px(bankai-light-theme('layout-grid-base'))};
        }
    }

    &__remove-all-action {
        &.bankai-button--link {
            color: var(--bankai-color-btn-secondary-destructive-default-text, bankai-light-theme('color-btn-secondary-destructive-default-text'));
            user-select: none;

            &.bankai-button--disabled:hover {
                cursor: default;
            }

            &:focus-visible {
                @include bankai-focus-state-box-shadow(var(--bankai-color-btn-secondary-destructive-focus-halo, bankai-light-theme('color-btn-secondary-destructive-focus-halo')));
            }
        }
    }

    // Mod Classes
    &--compact {
        width: 160px;
        height: 160px;
        border-radius: 100%;

        .bankai-dnd-file-uploader {
            &__inner {
                width: 160px;
                height: 160px;
                border-radius: 100%;
            }

            &__msg--default .bankai-dnd-file-uploader__msg-text {
                display: initial;
            }

            &__msg--default .bankai-dnd-file-uploader__browse-btn-container {
                margin-top: 0;
            }
        }
    }

    &--disabled {
        opacity: bankai-light-theme('state-disabled-opacity');
    }

    &--hover {
        color: var(--bankai-color-form-dnd-file-uploader-hover-state-text, bankai-light-theme('color-form-dnd-file-uploader-hover-state-text'));
        background-color: var(--bankai-color-form-dnd-file-uploader-hover-state-bg, bankai-light-theme('color-form-dnd-file-uploader-hover-state-bg'));
        border-color: var(--bankai-color-form-dnd-file-uploader-hover-state-border, bankai-light-theme('color-form-dnd-file-uploader-hover-state-border'));
    }

    &--rejected {
        color: var(--bankai-color-form-dnd-file-uploader-rejected-state-text, bankai-light-theme('color-form-dnd-file-uploader-rejected-state-text'));
        background-color: var(--bankai-color-form-dnd-file-uploader-rejected-state-bg, bankai-light-theme('color-form-dnd-file-uploader-rejected-state-bg'));
        border-color: var(--bankai-color-form-dnd-file-uploader-rejected-state-border, bankai-light-theme('color-form-dnd-file-uploader-rejected-state-border'));
    }

    &--busy {
        .bankai-icon-spinner {
            @include bankai-rotate-infinite;
        }
    }

    &--default,
    &--attachment,
    &--busy {
        background-color: var(--bankai-color-canvas-alt, bankai-light-theme('color-canvas-alt'));
    }
}
