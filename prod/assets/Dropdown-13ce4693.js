import{c as X,j as mt}from"./localeUtils-d4c6437e.js";import{P as e}from"./index-f9722e9b.js";import{r as f,R as u}from"./index-c013ead5.js";import{i as yt,u as ae,a as le,d as gt,e as ht,W as bt,f as Ct,c as vt,n as A,j as wt}from"./extantPropsUtils-b10ffe52.js";import{e as Dt,u as St,a as Ot,b as xt,c as Pt,F as Tt,d as It,p as qt,B as Lt,S as Ft}from"./SelectIcon-9570cae3.js";import{c as Vt,D as Et,A as At,C as Bt}from"./PickerCaret-f8638046.js";import{P as Rt,u as jt}from"./useDropdownToggle-d5a990c5.js";import{a as ie,e as ue,d as Te,m as ce}from"./PropTypes-94435e28.js";import{u as Kt}from"./useAutoFocus-aa837e29.js";import{u as Nt}from"./Localization-5aa5bb39.js";const de=2**31-1;function Ie(l,s,o){const r=o-Date.now();l.current=r<=de?setTimeout(s,r):setTimeout(()=>Ie(l,s,o),de)}function _t(){const l=yt(),s=f.useRef();return Dt(()=>clearTimeout(s.current)),f.useMemo(()=>{const o=()=>clearTimeout(s.current);function r(i,c=0){l()&&(o(),c<=de?s.current=setTimeout(i,c):Ie(s,i,Date.now()+c))}return{set:r,clear:o}},[])}const qe=u.forwardRef(function({name:l,autoComplete:s,value:o,allowSearch:r,placeholder:i,textAccessor:c,dataKeyAccessor:C,searchTerm:D,onSearch:R,onAutofill:b,onAutofillChange:j,renderValue:x,disabled:P,readOnly:T},J){const[K,m]=f.useState(!1),N=f.useRef(null),Q=({animationName:y})=>{let q;if(y==="react-widgets-autofill-start")q=!0;else if(y==="react-widgets-autofill-cancel")q=!1;else return;m(q),b(q)},Z=y=>{m(!1),j(y)};let _=C(o),W=o==null?"":c(o),I=String(_??"");I===String({})&&(I="");const G=!o&&i?u.createElement("span",{className:"rw-placeholder"},i):x?x({item:o,dataKey:_,text:W}):W;f.useImperativeHandle(J,()=>({focus(){N.current&&N.current.focus()}}));const k=K?{display:"none"}:void 0;return u.createElement("div",{className:"rw-dropdown-list-input"},s!=="off"&&u.createElement("input",{name:l,tabIndex:-1,disabled:P,readOnly:T,value:I??"",autoComplete:s,onChange:Z,onAnimationStart:Q,"aria-hidden":!K,className:X("rw-detect-autofill",!K&&"rw-sr")}),u.createElement(u.Fragment,null,r&&u.createElement("input",{ref:N,disabled:P,readOnly:T,style:k,className:"rw-dropdownlist-search",autoComplete:"off",value:D||"",size:(D||"").length+2,onChange:R}),!D&&u.createElement("span",{className:"rw-dropdown-list-value",style:k},G)))});qe.displayName="DropdownListInput";const kt=["id","autoFocus","textField","dataKey","value","defaultValue","onChange","open","defaultOpen","onToggle","searchTerm","defaultSearchTerm","onSearch","filter","allowCreate","delay","focusFirstItem","className","containerClassName","placeholder","busy","disabled","readOnly","selectIcon","busySpinner","dropUp","tabIndex","popupTransition","name","autoComplete","onSelect","onCreate","onKeyPress","onKeyDown","onClick","inputProps","listProps","popupProps","renderListItem","renderListGroup","optionComponent","renderValue","groupBy","onBlur","onFocus","listComponent","popupComponent","data","messages"];function B(){return B=Object.assign||function(l){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(l[r]=o[r])}return l},B.apply(this,arguments)}function Ut(l,s){if(l==null)return{};var o={},r=Object.keys(l),i,c;for(c=0;c<r.length;c++)i=r[c],!(s.indexOf(i)>=0)&&(o[i]=l[i]);return o}const $t={value:e.any,onChange:e.func,open:e.bool,onToggle:e.func,data:e.array,dataKey:ie,textField:ie,allowCreate:e.oneOf([!0,!1,"onFilter"]),renderValue:e.func,renderListItem:e.func,listComponent:ue,optionComponent:ue,renderPopup:e.func,renderListGroup:e.func,groupBy:ie,onSelect:e.func,onCreate:e.func,onSearch:e.func,searchTerm:e.string,busy:e.bool,selectIcon:e.node,busySpinner:e.node,placeholder:e.string,dropUp:e.bool,popupTransition:ue,disabled:Te.acceptsArray,readOnly:Te,containerClassName:e.string,inputProps:e.object,listProps:e.object,messages:e.shape({open:e.string,emptyList:ce,emptyFilter:ce,createOption:ce})};function Wt(l){const s=_t(),o=f.useRef("");function r(i,c){let C=(o.current+i).toLowerCase();i&&(o.current=C,s.set(()=>{o.current="",c(C)},l))}return r}const pe=u.forwardRef(function(s,o){let{id:r,autoFocus:i,textField:c,dataKey:C,value:D,defaultValue:R,onChange:b,open:j,defaultOpen:x=!1,onToggle:P,searchTerm:T,defaultSearchTerm:J="",onSearch:K,filter:m=!0,allowCreate:N=!1,delay:Q=500,focusFirstItem:Z,className:_,containerClassName:W,placeholder:I,busy:G,disabled:k,readOnly:y,selectIcon:q=vt,busySpinner:Le,dropUp:fe,tabIndex:Fe,popupTransition:Ve,name:Ee,autoComplete:Ae,onSelect:Be,onCreate:Re,onKeyPress:je,onKeyDown:Ke,onClick:Ne,inputProps:_e,listProps:ke,popupProps:Ue,renderListItem:$e,renderListGroup:We,optionComponent:Ge,renderValue:Me,groupBy:He,onBlur:ze,onFocus:Xe,listComponent:Ye=It,popupComponent:Je=Rt,data:ee=[],messages:Qe}=s,U=Ut(s,kt);const[L,Ze]=ae(D,R,b),[a,et]=ae(j,x,P),[h,tt]=ae(T,J,K),F=f.useRef(null),me=f.useRef(null),ye=f.useRef(null),ge=le(r,"_input"),$=le(r,"_listbox"),he=le(r,"_listbox_active_option"),p=St(c,C),te=Nt(Qe);Kt(!!i,F);const v=jt(a,et),w=k===!0,be=!!y,[nt,Ce]=gt(F,{disabled:w,onBlur:ze,onFocus:Xe},{didHandle(t){if(t){m&&S();return}v.close(),M()}}),V=Ot(ee,a?m:!1,h,p.text),ve=f.useMemo(()=>V[p.indexOf(V,L)],[V,L,p]),d=xt({activeId:he,scope:F,focusFirstItem:Z,anchorItem:a?ve:void 0}),[ot,st]=f.useState(!1),rt=Wt(Q),we=d.getFocused();Pt(F,he,we&&a,[we]);const De=Vt(N,{searchTerm:h,data:V,accessors:p}),ne=t=>{A(Re,[h]),M(t),v.close(),S()},Se=(t,n)=>{if(!(y||w)&&t!==void 0){if(n==null||n.preventDefault(),t===Bt){ne(n);return}A(Be,[t,{originalEvent:n}]),oe(t,n,!0),v.close(),S()}},at=t=>{y||w||(t.preventDefault(),S(),v(),A(Ne,[t]))},lt=t=>{if(y||w)return;let{key:n,altKey:g,ctrlKey:E,shiftKey:H}=t;A(Ke,[t]);let O=()=>{M(),v.close(),a&&setTimeout(S)};if(!t.defaultPrevented){if(n==="End"&&a&&!H)t.preventDefault(),d.focus(d.last());else if(n==="Home"&&a&&!H)t.preventDefault(),d.focus(d.first());else if(n==="Escape"&&(a||h))t.preventDefault(),O();else if(n==="Enter"&&a&&E&&De)t.preventDefault(),ne(t);else if((n==="Enter"||n===" "&&!m)&&a)t.preventDefault(),d.hasFocused()&&Se(d.getFocused(),t);else if(n==="ArrowDown"){if(t.preventDefault(),!a){v.open();return}d.focus(d.next())}else if(n==="ArrowUp"){if(t.preventDefault(),g)return O();d.focus(d.prev())}}},it=t=>{y||w||(A(je,[t]),!(t.defaultPrevented||m)&&rt(String.fromCharCode(t.which),n=>{if(!a)return;let g=re=>qt.startsWith(p.text(re).toLowerCase(),n.toLowerCase());const[E,H]=d.get(),O=E.length,xe=E.indexOf(H)+1,Pe=xe>=O?0:xe;let z=0,se=Pe;for(;z<O;){se=(z+Pe)%O;let re=E[se];if(g(d.toDataItem(re)))break;z++}z!==O&&d.focus(E[se])}))},ut=t=>{!a&&!t.target.value.trim()?t.preventDefault():Oe(t.target.value,t,"input"),v.open()},ct=t=>{let n=t.target.value.toLowerCase();if(n==="")return void oe(null);for(const g of ee)if(String(p.value(g)).toLowerCase()===n||p.text(g).toLowerCase()===n){oe(g,t);break}};function oe(t,n,g=!1){p.matches(t,L)||(A(Ze,[t,{originalEvent:n,source:g?"listbox":"input",lastValue:L,searchTerm:h}]),M(n),v.close())}function S(){m?me.current.focus():F.current.focus()}function M(t){Oe("",t,"clear")}function Oe(t,n,g="input"){h!==t&&tt(t,{action:g,originalEvent:n,lastSearchTerm:h})}f.useImperativeHandle(o,()=>({focus:S}));let dt=p.findOrSelf(V,L),pt=ht(Ce,a);const ft=Object.assign({},U,{role:"combobox",id:ge,tabIndex:m?-1:Fe||0,"aria-owns":U["aria-owns"]?`${$} ${U["aria-owns"]}`:$,"aria-controls":U["aria-controls"]?`${$} ${U["aria-controls"]}`:$,"aria-expanded":!!a,"aria-haspopup":"listbox","aria-busy":!!G,"aria-live":a?"polite":void 0,"aria-autocomplete":"list","aria-disabled":w,"aria-readonly":be});return u.createElement(Tt.Provider,{value:d.context},u.createElement(bt,B({},ft,{open:!!a,dropUp:!!fe,focused:!!Ce,disabled:w,readOnly:be,autofilling:ot},nt,{onKeyDown:lt,onKeyPress:it,className:X(_,"rw-dropdown-list"),ref:F}),u.createElement(Ct,{onClick:at,tabIndex:m?-1:0,className:X(W,"rw-widget-input")},u.createElement(qe,B({},_e,{value:dt,dataKeyAccessor:p.value,textAccessor:p.text,name:Ee,readOnly:y,disabled:w,allowSearch:!!m,searchTerm:h,ref:me,autoComplete:Ae,onSearch:ut,onAutofill:st,onAutofillChange:ct,placeholder:I,renderValue:Me})),u.createElement(Et,{visible:!0,busy:G,icon:q,spinner:Le})),pt&&u.createElement(Je,B({},Ue,{dropUp:fe,open:a,transition:Ve,onEntered:S,onEntering:()=>ye.current.scrollIntoView()}),u.createElement(Ye,B({},ke,{id:$,data:V,tabIndex:-1,disabled:k,groupBy:He,searchTerm:h,accessors:p,renderItem:$e,renderGroup:We,optionComponent:Ge,value:ve,onChange:(t,n)=>Se(t,n.originalEvent),"aria-live":a?"polite":void 0,"aria-labelledby":ge,"aria-hidden":!a,ref:ye,messages:{emptyList:ee.length?te.messages.emptyFilter:te.messages.emptyList}})),De&&u.createElement(At,{onSelect:ne},te.messages.createOption(L,h||"")))))});pe.displayName="DropdownList";pe.propTypes=$t;const Y=l=>{const{contextCls:s,hasError:o,filter:r,onChange:i,onSelect:c,onToggle:C,renderBusySpinner:D,renderSelectIcon:R}=l,b="bankai-dropdown",j={[`${b}--error`]:o,[`${b}--no-filter`]:!r},x=wt(l),P=D({baseCls:b}),T=R({baseCls:b});return mt(pe,{...x,className:X(b,j,s),busySpinner:P,selectIcon:T,onChange:i,onSelect:c,onToggle:C})};Y.defaultProps={filter:!1,hasError:!1,isBusy:!1,isDefaultOpen:!1,isDisabled:!1,isReadOnly:!1,shouldAutoFocus:!1,shouldDropUp:!1,data:[],onChange:()=>Promise.resolve(),onSelect:()=>Promise.resolve(),onToggle:()=>Promise.resolve(),renderBusySpinner:Lt,renderSelectIcon:Ft};Y.propTypes={contextCls:e.string,id:e.string,name:e.string,placeholder:e.string,delay:e.number,hasError:e.bool,isBusy:e.bool,isDefaultOpen:e.bool,isDisabled:e.bool,isOpen:e.bool,isReadOnly:e.bool,shouldAutoFocus:e.bool,shouldDropUp:e.bool,data:e.array,disabledOptions:e.array,inputProps:e.object,listProps:e.object,messages:e.object,dataKey:e.oneOfType([e.string,e.func]),defaultValue:e.oneOfType([e.string,e.array,e.object]),filter:e.oneOfType([e.string,e.func,e.bool]),groupBy:e.oneOfType([e.string,e.func]),listComponent:e.oneOfType([e.element,e.func]),optionComponent:e.oneOfType([e.element,e.string]),textField:e.oneOfType([e.string,e.func]),value:e.oneOfType([e.string,e.array,e.object]),onChange:e.func,onSelect:e.func,onToggle:e.func,renderBusySpinner:e.func,renderListGroup:e.func,renderListItem:e.func,renderSelectIcon:e.func,renderValue:e.func};const tn=Y;Y.__docgenInfo={description:"",methods:[],displayName:"Dropdown",props:{filter:{defaultValue:{value:"false",computed:!1},type:{name:"union",value:[{name:"string"},{name:"func"},{name:"bool"}]},required:!1,description:""},hasError:{defaultValue:{value:"false",computed:!1},type:{name:"bool"},required:!1,description:""},isBusy:{defaultValue:{value:"false",computed:!1},type:{name:"bool"},required:!1,description:""},isDefaultOpen:{defaultValue:{value:"false",computed:!1},type:{name:"bool"},required:!1,description:""},isDisabled:{defaultValue:{value:"false",computed:!1},type:{name:"bool"},required:!1,description:""},isReadOnly:{defaultValue:{value:"false",computed:!1},type:{name:"bool"},required:!1,description:""},shouldAutoFocus:{defaultValue:{value:"false",computed:!1},type:{name:"bool"},required:!1,description:""},shouldDropUp:{defaultValue:{value:"false",computed:!1},type:{name:"bool"},required:!1,description:""},data:{defaultValue:{value:"[]",computed:!1},type:{name:"array"},required:!1,description:""},onChange:{defaultValue:{value:"() => Promise.resolve()",computed:!1},type:{name:"func"},required:!1,description:""},onSelect:{defaultValue:{value:"() => Promise.resolve()",computed:!1},type:{name:"func"},required:!1,description:""},onToggle:{defaultValue:{value:"() => Promise.resolve()",computed:!1},type:{name:"func"},required:!1,description:""},renderBusySpinner:{defaultValue:{value:`(props) => {
    const { baseCls } = props;

    return <BankaiSpinner contextCls={\`\${baseCls}__busy-icon\`} />;
}`,computed:!1},type:{name:"func"},required:!1,description:""},renderSelectIcon:{defaultValue:{value:`(props) => {
    const { baseCls } = props;

    return <BankaiChevronDown contextCls={\`\${baseCls}__select-icon\`} />;
}`,computed:!1},type:{name:"func"},required:!1,description:""},contextCls:{type:{name:"string"},required:!1,description:""},id:{type:{name:"string"},required:!1,description:""},name:{type:{name:"string"},required:!1,description:""},placeholder:{type:{name:"string"},required:!1,description:""},delay:{type:{name:"number"},required:!1,description:""},isOpen:{type:{name:"bool"},required:!1,description:""},disabledOptions:{type:{name:"array"},required:!1,description:""},inputProps:{type:{name:"object"},required:!1,description:""},listProps:{type:{name:"object"},required:!1,description:""},messages:{type:{name:"object"},required:!1,description:""},dataKey:{type:{name:"union",value:[{name:"string"},{name:"func"}]},required:!1,description:""},defaultValue:{type:{name:"union",value:[{name:"string"},{name:"array"},{name:"object"}]},required:!1,description:""},groupBy:{type:{name:"union",value:[{name:"string"},{name:"func"}]},required:!1,description:""},listComponent:{type:{name:"union",value:[{name:"element"},{name:"func"}]},required:!1,description:""},optionComponent:{type:{name:"union",value:[{name:"element"},{name:"string"}]},required:!1,description:""},textField:{type:{name:"union",value:[{name:"string"},{name:"func"}]},required:!1,description:""},value:{type:{name:"union",value:[{name:"string"},{name:"array"},{name:"object"}]},required:!1,description:""},renderListGroup:{type:{name:"func"},required:!1,description:""},renderListItem:{type:{name:"func"},required:!1,description:""},renderValue:{type:{name:"func"},required:!1,description:""}}};export{tn as B};
//# sourceMappingURL=Dropdown-13ce4693.js.map
